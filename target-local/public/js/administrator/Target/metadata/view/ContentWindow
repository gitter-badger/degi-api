{
    "type": "Ext.window.Window",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "contentwindow",
        "designer|userClassName": "ContentWindow",
        "height": 420,
        "id": "contentwindow",
        "layout": "fit",
        "modal": true,
        "title": "My Window",
        "width": 720,
        "x": null,
        "y": 150
    },
    "name": "MyWindow",
    "designerId": "7ff0b2f5-97e3-4df1-a06c-92fa3f57c0b0",
    "viewControllerInstanceId": "f04aa399-4046-4592-9e85-9b683fef6429",
    "viewModelInstanceId": "d978b75e-0291-475b-b52f-94b5d2b35d11",
    "cn": [
        {
            "type": "Ext.form.field.Hidden",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fieldLabel": "Label",
                "id": "c_id",
                "name": "c_id"
            },
            "name": "MyHiddenField",
            "designerId": "91d8cdba-3f5a-498c-a6d3-62c4ffacda93"
        },
        {
            "type": "Ext.form.field.Hidden",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fieldLabel": "Label",
                "id": "cKeyTemp",
                "name": "c_id"
            },
            "name": "MyHiddenField2",
            "designerId": "239e4391-9473-4b3b-82e8-c1880a68ce44"
        },
        {
            "type": "Ext.form.field.Hidden",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fieldLabel": "Label",
                "id": "cValueTemp"
            },
            "name": "MyHiddenField1",
            "designerId": "fbf464c5-b415-4d1f-bb9a-4086184979d6"
        },
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "bodyPadding": 10,
                "id": "contentForm",
                "title": ""
            },
            "name": "MyForm",
            "designerId": "eb24f3b0-38b7-4138-be83-628b3a646adf",
            "cn": [
                {
                    "type": "Ext.form.field.Display",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fieldLabel": "描述",
                        "layout|anchor": "100%",
                        "name": "c_desc",
                        "value": "Display Field"
                    },
                    "name": "MyDisplayField",
                    "designerId": "efcf1096-8e66-4b17-8864-6de6758fff84"
                },
                {
                    "type": "Ext.form.field.TextArea",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "border": null,
                        "fieldLabel": null,
                        "formBind": false,
                        "height": null,
                        "id": "ckreplace",
                        "layout|anchor": "98%",
                        "name": "c_value",
                        "width": null
                    },
                    "name": "MyTextArea3",
                    "designerId": "180f1768-f115-4474-8407-cb242516ca62"
                },
                {
                    "type": "Ext.toolbar.Toolbar",
                    "reference": {
                        "name": "dockedItems",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "container|pack": "end",
                        "dock": "bottom"
                    },
                    "name": "MyToolbar1",
                    "designerId": "00c2d271-8127-44fc-850d-1c7418c179e3",
                    "cn": [
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null,
                                "text": "修改"
                            },
                            "name": "MyButton6",
                            "designerId": "e7c1e026-31eb-4beb-863b-a86ac31661dd",
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onButtonClick",
                                        "implHandler": [
                                            "// console.log(content_editor.getData());",
                                            "var cId = Ext.getCmp('c_id').getValue();",
                                            "var form = Ext.getCmp('contentForm').getForm();",
                                            "var cKeyTemp = Ext.getCmp('cKeyTemp').getValue();",
                                            "if(form.isValid()){",
                                            "    if(cKeyTemp !== 'product_lastdate'){",
                                            "        //console.log(content_editor.getData());",
                                            "        form.findField('c_value').setValue(content_editor.getData());",
                                            "        //console.log(form.findField('c_value').getValue());",
                                            "    }",
                                            "    form.submit({",
                                            "        // params: Ext.util.JSON.encode(form.getValues()),",
                                            "        method: 'PUT',",
                                            "        waitTitle:'訊息',",
                                            "        waitMsg:'修改資料中',",
                                            "        url:'http://dev.finpo.com.tw/posh/public/b/content/'+cId,",
                                            "",
                                            "        success:function(form,action){",
                                            "",
                                            "            var store  = Ext.getCmp('contentgridpanel').getViewModel().getStore('ContentStore');",
                                            "            store.proxy.url='http://dev.finpo.com.tw/posh/public/b/content';",
                                            "            store.load();",
                                            "",
                                            "            form.reset();",
                                            "            Ext.Msg.alert('訊息','文案修改成功', function(){",
                                            "                var window = Ext.getCmp('contentwindow');",
                                            "                window.close();",
                                            "            });",
                                            "",
                                            "        },",
                                            "        failure:function(form,action){",
                                            "",
                                            "           Ext.Msg.alert('訊息','管理者新增失敗');",
                                            "",
                                            "        }",
                                            "",
                                            "    });",
                                            "}"
                                        ],
                                        "name": "click",
                                        "scope": "me"
                                    },
                                    "name": "onButtonClick",
                                    "designerId": "6862e700-7d7b-4cd6-8dba-00c608a00192"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "basiceventbinding",
                    "reference": {
                        "name": "listeners",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fn": "onContentFormAfterRender",
                        "implHandler": [
                            "var cId = Ext.getCmp('c_id').getValue();",
                            "",
                            "Ext.Ajax.request({",
                            "    url: 'http://dev.finpo.com.tw/posh/public/b/content/'+cId,",
                            "    success: function(response, opts){",
                            "        var obj = Ext.JSON.decode(response.responseText);",
                            "        cValue = obj.data.c_value;",
                            "        //console.log(cValue);",
                            "        var form = Ext.getCmp('contentForm').getForm();",
                            "        form.setValues(obj.data);",
                            "        if(obj.data.c_key !== 'product_lastdate' && obj.data.c_key !== 'line_link'){",
                            "            Ext.getCmp('cKeyTemp').setValue(obj.data.c_key);",
                            "            content_editor = CKEDITOR.replace('ckreplace');",
                            "            content_editor.setData(cValue);",
                            "        }else{",
                            "            Ext.getCmp('cKeyTemp').setValue(obj.data.c_key);",
                            "            Ext.getCmp('cValueTemp').setValue(obj.data.c_value);",
                            "            //console.log(Ext.getCmp('cValueTemp').getValue());",
                            "        }",
                            "",
                            "    },",
                            "    failure: function(response, opts){",
                            "        console.log('server-side failure with status code ' + response.status);",
                            "    }",
                            "});"
                        ],
                        "name": "afterrender",
                        "scope": "me"
                    },
                    "name": "onContentFormAfterRender",
                    "designerId": "8b56af8b-5ce7-4c26-b71c-47a263a1db63"
                }
            ]
        }
    ]
}